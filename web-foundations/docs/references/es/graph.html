---
layout: default
title: Mapa de Referencias (ES)
lang: es
permalink: /references/es/graph.html
---

<h1>Mapa de Referencias (ES)</h1>

<div id="graph-ui" class="prose">
	<p class="muted">Pulsa un nodo de documento para ver sus detalles. Arrastra para explorar. Rueda para hacer zoom.</p>
	<div
		id="details"
		style="
			margin: 0.5rem 0 1rem;
			padding: 0.5rem;
			border: 1px solid var(--border-light);
			border-radius: 6px;
			background: var(--bg);
		"></div>
</div>
<div id="cy" style="width: 100%; height: 70vh; border: 1px solid var(--border-light); border-radius: 8px"></div>

<script src="https://unpkg.com/cytoscape@3.28.1/dist/cytoscape.min.js" crossorigin="anonymous"></script>
<script>
	fetch('{{ '/assets/data/graph.json' | relative_url }}')
	  .then(r => r.json())
	  .then(graph => {
	    const cy = cytoscape({
		    container: document.getElementById('cy'),
		    elements: graph.elements,
		    style: [
		      { selector: 'node[type="doc"]', style: { 'background-color': '#1d4ed8', 'label': 'data(label)', 'color': '#fff', 'font-size': 10, 'text-wrap': 'wrap', 'text-max-width': 180 } },
		      { selector: 'node[type="tag"]', style: { 'background-color': '#10b981', 'label': 'data(label)', 'shape': 'round-rectangle', 'font-size': 9, 'color': '#0f172a' } },
		      { selector: 'node[type="entity"]', style: { 'background-color': '#64748b', 'label': 'data(label)', 'shape': 'diamond', 'font-size': 9, 'color': '#0f172a' } },
		      { selector: 'edge[label="links"]', style: { 'width': 1, 'line-color': '#cbd5e1', 'target-arrow-color': '#cbd5e1', 'target-arrow-shape': 'triangle' } },
		      { selector: 'edge[label="hasTag"]', style: { 'width': 1, 'line-color': '#10b981', 'target-arrow-color': '#10b981', 'target-arrow-shape': 'triangle' } },
		      { selector: 'edge[label="mentions"]', style: { 'width': 1, 'line-color': '#94a3b8', 'target-arrow-color': '#94a3b8', 'target-arrow-shape': 'triangle' } }
		    ],
	    layout: { name: 'cose', animate: true },
	    wheelSensitivity: 1
		  });
	  cy.style().selector('core').style({ 'active-bg-color': '#e5e7eb', 'selection-box-color': '#cbd5e1', 'outside-texture-bg-color': '#e0e0e0' }).update();

	  const details = document.getElementById('details');
	  function formatSources(sources){
	    if (!sources || !sources.length) return '<em>Sin fuentes</em>';
	    return sources.map(s => `<li><em>${s.title||s.path}</em> <a href="${'{{ '/' | relative_url }}'+(s.href||s.path)}" target="_blank" rel="noopener">\u279A</a></li>`).join('');
	  }

	  cy.on('tap', 'node[type="doc"]', function(evt){
	    const d = evt.target.data();
	    const label = d.label || d.url;
	    const domain = d.domain || '';
	    const status = d.status ? (' ('+d.status+')') : '';
	    const sources = Array.isArray(d.sourcesMeta) ? d.sourcesMeta : (Array.isArray(d.sources)? d.sources.map(p => ({title:p, href:p, path:p})) : []);
	    details.innerHTML = `<div><strong>${label}</strong><br/><span class="muted">${domain}${status}</span></div>
	      <div style="margin-top:0.5rem"><strong>Fuentes:</strong><ul>${formatSources(sources)}</ul></div>`;
	  });
	})
	.catch(err => console.error('Error loading graph:', err));
</script>
